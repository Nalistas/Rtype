<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dalton&#39;s RType: WebSocket Client &amp; Server Implementation for Node</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Dalton&#39;s RType<span id="projectnumber">&#160;v0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">WebSocket Client &amp; Server Implementation for Node</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://badge.fury.io/js/websocket"><img src="https://badge.fury.io/js/websocket.svg" alt="npm version" style="pointer-events: none;" class="inline"/></a></p>
<p><a href="https://www.npmjs.com/package/websocket"><img src="https://img.shields.io/npm/dm/websocket.svg" alt="NPM Downloads" style="pointer-events: none;" class="inline"/></a></p>
<p><a href="https://codeship.com/projects/61106"><img src="https://codeship.com/projects/70458270-8ee7-0132-7756-0a0cf4fe8e66/status?branch=master" alt="Codeship Status for theturtle32/WebSocket-Node" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md7353"></a>
Overview</h1>
<p>This is a (mostly) pure JavaScript implementation of the WebSocket protocol versions 8 and 13 for Node. There are some example client and server applications that implement various interoperability testing protocols in the "test/scripts" folder.</p>
<h1><a class="anchor" id="autotoc_md7354"></a>
Documentation</h1>
<p>You can read the full API documentation in the docs folder.</p>
<h2><a class="anchor" id="autotoc_md7355"></a>
Changelog</h2>
<p><em><b>Current Version: 1.0.35</b></em> - Release 2024-05-12</p>
<ul>
<li><a href="https://github.com/theturtle32/WebSocket-Node/pull/455">Updated</a> from <a href="https://security.snyk.io/vuln/SNYK-JS-ES5EXT-6095076">vulnerable version</a> of es5-ext to a newer version that has been patched. Thanks, <a href="https://github.com/Tringapps-Dharshan">@Tringapps-Dharshan</a></li>
</ul>
<p><a class="el" href="md__2home_2solype_2delivery_2current__days_2Mannheim_2front_2node__modules_2websocket_2CHANGELOG.html">View the full changelog</a></p>
<h2><a class="anchor" id="autotoc_md7356"></a>
Browser Support</h2>
<p>All current browsers are fully* supported.</p>
<ul>
<li>Firefox 7-9 (Old) (Protocol Version 8)</li>
<li>Firefox 10+ (Protocol Version 13)</li>
<li>Chrome 14,15 (Old) (Protocol Version 8)</li>
<li>Chrome 16+ (Protocol Version 13)</li>
<li>Internet Explorer 10+ (Protocol Version 13)</li>
<li>Safari 6+ (Protocol Version 13)</li>
</ul>
<p>(Not all W3C WebSocket features are supported by browsers. More info in the Full API documentation)</p>
<h2><a class="anchor" id="autotoc_md7357"></a>
Benchmarks</h2>
<p>There are some basic benchmarking sections in the Autobahn test suite. I've put up a <a href="http://theturtle32.github.com/WebSocket-Node/benchmarks/">benchmark page</a> that shows the results from the Autobahn tests run against AutobahnServer 0.4.10, WebSocket-Node 1.0.2, WebSocket-Node 1.0.4, and ws 0.3.4.</p>
<p>(These benchmarks are quite a bit outdated at this point, so take them with a grain of salt. Anyone up for running new benchmarks? I'll link to your report.)</p>
<h2><a class="anchor" id="autotoc_md7358"></a>
Autobahn Tests</h2>
<p>The very complete <a href="http://autobahn.ws/testsuite/">Autobahn Test Suite</a> is used by most WebSocket implementations to test spec compliance and interoperability.</p>
<ul>
<li><a href="http://theturtle32.github.com/WebSocket-Node/test-report/servers/">View Server Test Results</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md7359"></a>
Installation</h2>
<p>In your project root: </p><pre class="fragment">$ npm install websocket
</pre><p> Then in your code:</p>
<div class="fragment"><div class="line">var WebSocketServer = require(&#39;websocket&#39;).server;</div>
<div class="line">var WebSocketClient = require(&#39;websocket&#39;).client;</div>
<div class="line">var WebSocketFrame  = require(&#39;websocket&#39;).frame;</div>
<div class="line">var WebSocketRouter = require(&#39;websocket&#39;).router;</div>
<div class="line">var W3CWebSocket = require(&#39;websocket&#39;).w3cwebsocket;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7360"></a>
Current Features:</h2>
<ul>
<li>Licensed under the Apache License, Version 2.0</li>
<li>Protocol version "8" and "13" (Draft-08 through the final RFC) framing and handshake</li>
<li>Can handle/aggregate received fragmented messages</li>
<li>Can fragment outgoing messages</li>
<li>Router to mount multiple applications to various path and protocol combinations</li>
<li>TLS supported for outbound connections via WebSocketClient</li>
<li>TLS supported for server connections (use https.createServer instead of http.createServer)<ul>
<li>Thanks to <a href="https://github.com/pors">pors</a> for confirming this!</li>
</ul>
</li>
<li>Cookie setting and parsing</li>
<li>Tunable settings<ul>
<li>Max Receivable Frame Size</li>
<li>Max Aggregate ReceivedMessage Size</li>
<li>Whether to fragment outgoing messages</li>
<li>Fragmentation chunk size for outgoing messages</li>
<li>Whether to automatically send ping frames for the purposes of keepalive</li>
<li>Keep-alive ping interval</li>
<li>Whether or not to automatically assemble received fragments (allows application to handle individual fragments directly)</li>
<li>How long to wait after sending a close frame for acknowledgment before closing the socket.</li>
</ul>
</li>
<li><a href="http://www.w3.org/TR/websockets/">W3C WebSocket API</a> for applications running on both Node and browsers (via the <code>W3CWebSocket</code> class).</li>
</ul>
<h2><a class="anchor" id="autotoc_md7361"></a>
Known Issues/Missing Features:</h2>
<ul>
<li>No API for user-provided protocol extensions.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7362"></a>
Usage Examples</h1>
<h2><a class="anchor" id="autotoc_md7363"></a>
Server Example</h2>
<p>Here's a short example showing a server that echos back anything sent to it, whether utf-8 or binary.</p>
<div class="fragment"><div class="line">#!/usr/bin/env node</div>
<div class="line">var WebSocketServer = require(&#39;websocket&#39;).server;</div>
<div class="line">var http = require(&#39;http&#39;);</div>
<div class="line"> </div>
<div class="line">var server = http.createServer(function(request, response) {</div>
<div class="line">    console.log((new Date()) + &#39; Received request for &#39; + request.url);</div>
<div class="line">    response.writeHead(404);</div>
<div class="line">    response.end();</div>
<div class="line">});</div>
<div class="line">server.listen(8080, function() {</div>
<div class="line">    console.log((new Date()) + &#39; Server is listening on port 8080&#39;);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">wsServer = new WebSocketServer({</div>
<div class="line">    httpServer: server,</div>
<div class="line">    // You should not use autoAcceptConnections for production</div>
<div class="line">    // applications, as it defeats all standard cross-origin protection</div>
<div class="line">    // facilities built into the protocol and the browser.  You should</div>
<div class="line">    // *always* verify the connection&#39;s origin and decide whether or not</div>
<div class="line">    // to accept it.</div>
<div class="line">    autoAcceptConnections: false</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">function originIsAllowed(origin) {</div>
<div class="line">  // put logic here to detect whether the specified origin is allowed.</div>
<div class="line">  return true;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">wsServer.on(&#39;request&#39;, function(request) {</div>
<div class="line">    if (!originIsAllowed(request.origin)) {</div>
<div class="line">      // Make sure we only accept requests from an allowed origin</div>
<div class="line">      request.reject();</div>
<div class="line">      console.log((new Date()) + &#39; Connection from origin &#39; + request.origin + &#39; rejected.&#39;);</div>
<div class="line">      return;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    var connection = request.accept(&#39;echo-protocol&#39;, request.origin);</div>
<div class="line">    console.log((new Date()) + &#39; Connection accepted.&#39;);</div>
<div class="line">    connection.on(&#39;message&#39;, function(message) {</div>
<div class="line">        if (message.type === &#39;utf8&#39;) {</div>
<div class="line">            console.log(&#39;Received Message: &#39; + message.utf8Data);</div>
<div class="line">            connection.sendUTF(message.utf8Data);</div>
<div class="line">        }</div>
<div class="line">        else if (message.type === &#39;binary&#39;) {</div>
<div class="line">            console.log(&#39;Received Binary Message of &#39; + message.binaryData.length + &#39; bytes&#39;);</div>
<div class="line">            connection.sendBytes(message.binaryData);</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line">    connection.on(&#39;close&#39;, function(reasonCode, description) {</div>
<div class="line">        console.log((new Date()) + &#39; Peer &#39; + connection.remoteAddress + &#39; disconnected.&#39;);</div>
<div class="line">    });</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7364"></a>
Client Example</h2>
<p>This is a simple example client that will print out any utf-8 messages it receives on the console, and periodically sends a random number.</p>
<p><em>This code demonstrates a client in Node.js, not in the browser</em></p>
<div class="fragment"><div class="line">#!/usr/bin/env node</div>
<div class="line">var WebSocketClient = require(&#39;websocket&#39;).client;</div>
<div class="line"> </div>
<div class="line">var client = new WebSocketClient();</div>
<div class="line"> </div>
<div class="line">client.on(&#39;connectFailed&#39;, function(error) {</div>
<div class="line">    console.log(&#39;Connect Error: &#39; + error.toString());</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">client.on(&#39;connect&#39;, function(connection) {</div>
<div class="line">    console.log(&#39;WebSocket Client Connected&#39;);</div>
<div class="line">    connection.on(&#39;error&#39;, function(error) {</div>
<div class="line">        console.log(&quot;Connection Error: &quot; + error.toString());</div>
<div class="line">    });</div>
<div class="line">    connection.on(&#39;close&#39;, function() {</div>
<div class="line">        console.log(&#39;echo-protocol Connection Closed&#39;);</div>
<div class="line">    });</div>
<div class="line">    connection.on(&#39;message&#39;, function(message) {</div>
<div class="line">        if (message.type === &#39;utf8&#39;) {</div>
<div class="line">            console.log(&quot;Received: &#39;&quot; + message.utf8Data + &quot;&#39;&quot;);</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line">    </div>
<div class="line">    function sendNumber() {</div>
<div class="line">        if (connection.connected) {</div>
<div class="line">            var number = Math.round(Math.random() * 0xFFFFFF);</div>
<div class="line">            connection.sendUTF(number.toString());</div>
<div class="line">            setTimeout(sendNumber, 1000);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    sendNumber();</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">client.connect(&#39;ws://localhost:8080/&#39;, &#39;echo-protocol&#39;);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7365"></a>
Client Example using the <em>W3C WebSocket API</em></h2>
<p>Same example as above but using the <a href="http://www.w3.org/TR/websockets/">W3C WebSocket API</a>.</p>
<div class="fragment"><div class="line">var W3CWebSocket = require(&#39;websocket&#39;).w3cwebsocket;</div>
<div class="line"> </div>
<div class="line">var client = new W3CWebSocket(&#39;ws://localhost:8080/&#39;, &#39;echo-protocol&#39;);</div>
<div class="line"> </div>
<div class="line">client.onerror = function() {</div>
<div class="line">    console.log(&#39;Connection Error&#39;);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">client.onopen = function() {</div>
<div class="line">    console.log(&#39;WebSocket Client Connected&#39;);</div>
<div class="line"> </div>
<div class="line">    function sendNumber() {</div>
<div class="line">        if (client.readyState === client.OPEN) {</div>
<div class="line">            var number = Math.round(Math.random() * 0xFFFFFF);</div>
<div class="line">            client.send(number.toString());</div>
<div class="line">            setTimeout(sendNumber, 1000);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    sendNumber();</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">client.onclose = function() {</div>
<div class="line">    console.log(&#39;echo-protocol Client Closed&#39;);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">client.onmessage = function(e) {</div>
<div class="line">    if (typeof e.data === &#39;string&#39;) {</div>
<div class="line">        console.log(&quot;Received: &#39;&quot; + e.data + &quot;&#39;&quot;);</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7366"></a>
Request Router Example</h2>
<p>For an example of using the request router, see <code>libwebsockets-test-server.js</code> in the <code>test</code> folder.</p>
<h2><a class="anchor" id="autotoc_md7367"></a>
Resources</h2>
<p>A presentation on the state of the WebSockets protocol that I gave on July 23, 2011 at the LA Hacker News meetup. <a href="http://www.scribd.com/doc/60898569/WebSockets-The-Real-Time-Web-Delivered">WebSockets: The Real-Time Web, Delivered</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dalton&#39;s RType: Protocol</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Dalton&#39;s RType<span id="projectnumber">&#160;v0.1</span>
   </div>
   <div id="projectbrief">This project is a game engine based on RAYLIB, for multiplayer game.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Protocol</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Introduction</h1>
<p>There is 2 type of connections :</p><ul>
<li>Tcp</li>
<li>Udp Each type of connection has its own protocol.</li>
</ul>
<p>Before starting, here is some useful notation</p><ol type="1">
<li><code>[]</code> indicate a pack of octet, with its title inside For exemple : <code>[id]</code> means there is a pack of octet dedicated for an id.</li>
</ol>
<p>If there is no further information, it means it is only 1 and only 1 octet in the previous exemple it would have means that the id is only composed of 1 octet</p>
<ol type="1">
<li><code>/{NB}o</code> idicate a number of octet. This notation goes inside the <code>[]</code> For exemple : <code>[ID/4o]</code> means there is a pack of octet that compose an ID and this id is composed of 4 octets In case of number and not ID, the bigger numbers come first. for exemple : <code>0x2F 34 2A B3</code> will be sent as : nb[0] : 2F nb[1] : 34 nb[2] : 2A nb[3] : B3</li>
</ol>
<p>It is also knows as little indian :3 <b>NB</b> sometimes, we can have <code>?</code> which means undifined number of octets, this notation is more for the strings.</p>
<ol type="1">
<li><code>...</code> is for "prefix", octet that has been declared as "global" Exemple : Global prefix :<code>[2][ID /4o]</code> the code : <code>...[<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> /4o]</code></li>
</ol>
<p>means that the full package is 9 octets longs :</p><ul>
<li>the single octet for <code>[2]</code> - that has the value 2</li>
<li>the ID on 4 octets <code>[ID /4o]</code></li>
<li>the speed on 4 octet <code>[<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> /4o]</code></li>
<li>the result is : <code>[2][ID /4o][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> /4o]</code> Because the code has <code>...</code> and that there is a global prefix, the complete code will be the concatenation of the prefixe and the rest. <b>NB</b> a prefix can have a prefix</li>
</ul>
<p>4 <code>[|]</code> is for choice it is to illustrate that there is a limited choice, often with a value and the signification Exemple : <code>[Key code][Pressed = 1 | Released = 2]</code> meanse that the package is made of 2 octets, the 1st is a key code, the seconde means "Pressed or Released" <code>[K][1]</code> means that the key "K" is pressed while <code>[A][2]</code> meanse that the key "A" is released</p>
<hr  />
<h1><a class="anchor" id="autotoc_md3"></a>
TCP</h1>
<p>First of all, at the beginning of all TCP request, there is 2 octets dedicated to the length of the request. Prefix : <code>[size /2o]</code></p>
<h2><a class="anchor" id="autotoc_md4"></a>
Server -&gt; Client</h2>
<ol type="1">
<li>OK If the previous instruction previously made succeed <code>...[200]</code></li>
<li>KO If the previous instruction previously made did not succeed <code>...[201]</code></li>
<li><a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> declaration This request is here to add a new room waiting for new player <code>...[1][new = 1 | deleted = 0][room id /1o][room name /?o]</code></li>
<li>Set ready It will declare you ready to play. You need to be in a room to set you ready. The game will start when all player are ready ! <code>...[2]</code></li>
<li>Load a sprite When the game is starting, the server will send to the client everything they need to play. <code>...[3][Id of the sprite /4o][Width /4o][Height /4o][Width text rect /4o][Height text rect /4o][X offset /4o][Y offset /4o][Number of frames /4o][nb milisecond per frame /4o][path to the image /?o]</code></li>
<li>Load a background <code>...[4][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a>][move on X axis = 1 | move on Y axis = 2][resize = 1 | do not = 0][loop = 1 | do not loop][Do not move = 1 | Parallax = 2 | Perpetual movement = 3][Path to image /?o]</code></li>
<li>Load a music <code>...[5][id musique][path to musique /?o]</code></li>
<li>Load an action <code>...[6][id action / 4o][key code / 4o][pressed = 1 | released = 0]</code></li>
<li>Transfert IpPort where the game will take place : <code>...[7][IP /4o][Port/2o][Player Id]</code> with : Ip : <code>[nb1 /1o][nb2 /1o][nb3 /1o][nb4 /1o]</code> =&gt; nb1.nb2.nb3.nb4 Port : <code>[nb1/1o][nb2/1o]</code> translation to string then concatenation, for exemple: 9809, NB1 = 98 et NB2 = 09. Translation to STR : NB1 = "98" NB2 = "09" then concatenation =&gt; "9809"</li>
<li>Declare an existing game: It sends you an existing game that you can select where you create a room <code>...[8][game name]</code></li>
<li>Someone entered/exited a room: <code>...[9][exited = 0 | entered = 1][<a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> id][name]</code></li>
<li>Force register in a room: It force register you in the room you have clicked on to enter <code>...[10][<a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> Id][<a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> Name]</code></li>
</ol>
<h2><a class="anchor" id="autotoc_md5"></a>
Client -&gt; Server</h2>
<ol type="1">
<li>Define a name <code>...[1][Name /?o]</code> Server response : OK | KO this instruction is mandatory, it is a loggin</li>
<li>Enter in a <a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> : <code>...[2][Id room /1o]</code> Server response : OK | KO</li>
<li>Leave the current room <code>...[4]</code> Server response : OK | KO this will make you leave the room if you are in one and set you not ready</li>
<li>List Games <code>...[5]</code> Server response : <code>...[8][game name]</code></li>
<li>Missing file <code>...[6][File path /?o]</code> Server response : OK[followed by the file (binary)] | KO when the server give you all the ressourses, it just gives the path. By default it assumes the client has everything. However, you can ask him the document and then it will give it to you</li>
<li>New <a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> <code>...[7][<a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a> Name /?o][92][Name of the game /?o]</code> Server response : OK | KO</li>
<li>List rooms <code>...[8]</code> Server response : <code>...[1][1][room id /1o][room name /?o]</code></li>
<li>Delete rooms <code>...[9][Id room]</code></li>
<li>Set ready or unready : <code>...[10]</code> Server response : OK | KO the game is launched if All player are set ready this command will set you ready is you are not and will set you not ready if you are</li>
</ol>
<p><b>NB</b> Be carefull, some instruction of the server can be sent before a response to a request. For exemple : <a class="el" href="classClient.html" title="Client class on server side This class is used to represent a client.">Client</a> &ndash;{Create a new <a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a>}--&gt; Server <a class="el" href="classClient.html" title="Client class on server side This class is used to represent a client.">Client</a> &lt;-{Declare a new <a class="el" href="classRoom.html" title="Class to represent a room This class is used to represent a room A room is a place where clients can ...">Room</a>}&ndash; Server <a class="el" href="classClient.html" title="Client class on server side This class is used to represent a client.">Client</a> &lt;-{OK to the creation}&ndash; Server as we can see here, the declaration of a new random room has been sent by the server before the confirmation of the room creation.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
UDP</h1>
<p>The UDP protocol is simpler compared to the TCP protocol. It focuses primarily on real-time interactions with limited responses.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
General Notes</h2>
<p>Unlike the TCP protocol, there is no prefix to indicate the packet length in UDP. However, the structure of packets is strictly defined. Below are the instructions:</p>
<hr  />
<h2><a class="anchor" id="autotoc_md9"></a>
Client -&gt; Server</h2>
<h3><a class="anchor" id="autotoc_md10"></a>
1. Ping to Stay Alive</h3>
<p>A simple packet sent to inform the server that the client is still connected. <br  />
 <b>Format:</b> <br  />
 <code>...[0]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md12"></a>
2. Trigger an Action</h3>
<p>A packet sent to initiate an action by the client. <br  />
 <b>Format:</b> <br  />
 <code>...[1][Action ID /1o][Mouse X <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o][Mouse Y <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md14"></a>
3. Request Screen Refresh</h3>
<p>A packet sent when the client needs the server to refresh the screen. <br  />
 <b>Format:</b> <br  />
 <code>...[2]</code></p>
<hr  />
<h2><a class="anchor" id="autotoc_md16"></a>
Server -&gt; Client</h2>
<h3><a class="anchor" id="autotoc_md17"></a>
1. Define a Background</h3>
<p>A packet sent to define the background to be displayed on the client. All graphical parameters are pre-configured via TCP. <br  />
 <b>Format:</b> <br  />
 <code>...[1][<a class="el" href="classBackground.html" title="Background class to handle the background and the parallax.">Background</a> ID /1o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md19"></a>
2. Create an Entity</h3>
<p>A packet sent to instruct the client to create a new entity on the screen. <br  />
 <b>Format:</b> <br  />
 <code>...[2][Entity Type ID /1o][Entity ID /2o][X <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o][Y <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> X /1o][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> Y /1o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md21"></a>
3. Delete an Entity</h3>
<p>A packet sent to instruct the client to remove an entity from the screen. <br  />
 <b>Format:</b> <br  />
 <code>...[3][Entity ID /2o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md23"></a>
4. Update Speed</h3>
<p>A packet sent to update the speed of an existing entity. <br  />
 <b>Format:</b> <br  />
 <code>...[4][Entity ID /2o][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> X /1o][<a class="el" href="structSpeed.html" title="Speed component.">Speed</a> Y /1o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md25"></a>
5. Update Position</h3>
<p>A packet sent to update the position of an existing entity. <br  />
 <b>Format:</b> <br  />
 <code>...[5][Entity ID /2o][X <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o][Y <a class="el" href="structPosition.html" title="Position component.">Position</a> /4o]</code></p>
<hr  />
<h3><a class="anchor" id="autotoc_md27"></a>
6. Play Music</h3>
<p>A packet sent to instruct the client to play a specific music file. <br  />
 <b>Format:</b> <br  />
 <code>...[6][Music ID /1o]</code></p>
<hr  />
<h2><a class="anchor" id="autotoc_md29"></a>
Notes on UDP Communication</h2>
<ol type="1">
<li><b>Unreliability</b>: Since UDP does not guarantee delivery, some packets may not reach their destination. This is acceptable for non-critical updates like position or speed changes, as newer updates will overwrite missing ones.</li>
<li><b>Real-Time Focus</b>: UDP is primarily used for real-time actions where delays should be minimal (e.g., triggering actions or updating positions). </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
